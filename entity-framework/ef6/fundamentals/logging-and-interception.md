---
title: Registrazione e intercettazione delle operazioni di database-EF6
description: Registrazione e intercettazione delle operazioni di database in Entity Framework 6
author: ajcvickers
ms.date: 10/23/2016
uid: ef6/fundamentals/logging-and-interception
ms.openlocfilehash: 97248af9953de4372503aa7340712f3eff19b6b8
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/14/2020
ms.locfileid: "92065433"
---
# <a name="logging-and-intercepting-database-operations"></a><span data-ttu-id="1048f-103">Registrazione e intercettazione delle operazioni di database</span><span class="sxs-lookup"><span data-stu-id="1048f-103">Logging and intercepting database operations</span></span>
> [!NOTE]
> <span data-ttu-id="1048f-104">**Solo EF6 e versioni successive**: funzionalità, API e altri argomenti discussi in questa pagina sono stati introdotti in Entity Framework 6.</span><span class="sxs-lookup"><span data-stu-id="1048f-104">**EF6 Onwards Only** - The features, APIs, etc. discussed in this page were introduced in Entity Framework 6.</span></span> <span data-ttu-id="1048f-105">Se si usa una versione precedente, le informazioni qui riportate, o parte di esse, non sono applicabili.</span><span class="sxs-lookup"><span data-stu-id="1048f-105">If you are using an earlier version, some or all of the information does not apply.</span></span>  

<span data-ttu-id="1048f-106">A partire da Entity Framework 6, in qualsiasi momento Entity Framework invia un comando al database, questo comando può essere intercettato dal codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-106">Starting with Entity Framework 6, anytime Entity Framework sends a command to the database this command can be intercepted by application code.</span></span> <span data-ttu-id="1048f-107">Questa operazione viene usata più di frequente per la registrazione di SQL, ma può essere usata anche per modificare o interrompere il comando.</span><span class="sxs-lookup"><span data-stu-id="1048f-107">This is most commonly used for logging SQL, but can also be used to modify or abort the command.</span></span>  

<span data-ttu-id="1048f-108">In particolare, EF include:</span><span class="sxs-lookup"><span data-stu-id="1048f-108">Specifically, EF includes:</span></span>  

- <span data-ttu-id="1048f-109">Proprietà di log per il contesto simile a DataContext. log in LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="1048f-109">A Log property for the context similar to DataContext.Log in LINQ to SQL</span></span>  
- <span data-ttu-id="1048f-110">Meccanismo per personalizzare il contenuto e la formattazione dell'output inviato al log</span><span class="sxs-lookup"><span data-stu-id="1048f-110">A mechanism to customize the content and formatting of the output sent to the log</span></span>  
- <span data-ttu-id="1048f-111">Blocchi predefiniti di basso livello per l'intercettazione che offrono maggiore controllo/flessibilità</span><span class="sxs-lookup"><span data-stu-id="1048f-111">Low-level building blocks for interception giving greater control/flexibility</span></span>  

## <a name="context-log-property"></a><span data-ttu-id="1048f-112">Proprietà log del contesto</span><span class="sxs-lookup"><span data-stu-id="1048f-112">Context Log property</span></span>  

<span data-ttu-id="1048f-113">La proprietà DbContext. database. log può essere impostata su un delegato per qualsiasi metodo che accetta una stringa.</span><span class="sxs-lookup"><span data-stu-id="1048f-113">The DbContext.Database.Log property can be set to a delegate for any method that takes a string.</span></span> <span data-ttu-id="1048f-114">In genere viene usato con qualsiasi TextWriter impostando il metodo "Write" del TextWriter.</span><span class="sxs-lookup"><span data-stu-id="1048f-114">Most commonly it is used with any TextWriter by setting it to the “Write” method of that TextWriter.</span></span> <span data-ttu-id="1048f-115">Tutti i SQL generati dal contesto corrente verranno registrati nel writer.</span><span class="sxs-lookup"><span data-stu-id="1048f-115">All SQL generated by the current context will be logged to that writer.</span></span> <span data-ttu-id="1048f-116">Il codice seguente, ad esempio, registrerà SQL sulla console:</span><span class="sxs-lookup"><span data-stu-id="1048f-116">For example, the following code will log SQL to the console:</span></span>  

``` csharp
using (var context = new BlogContext())
{
    context.Database.Log = Console.Write;

    // Your code here...
}
```  

<span data-ttu-id="1048f-117">Si noti che context. Database. log è impostato su console. Write.</span><span class="sxs-lookup"><span data-stu-id="1048f-117">Notice that context.Database.Log is set to Console.Write.</span></span> <span data-ttu-id="1048f-118">Questo è tutto ciò che serve per accedere a SQL alla console.</span><span class="sxs-lookup"><span data-stu-id="1048f-118">This is all that is needed to log SQL to the console.</span></span>  

<span data-ttu-id="1048f-119">È ora possibile aggiungere un semplice codice di query/inserimento/aggiornamento per visualizzare un output:</span><span class="sxs-lookup"><span data-stu-id="1048f-119">Let’s add some simple query/insert/update code so that we can see some output:</span></span>  

``` csharp
using (var context = new BlogContext())
{
    context.Database.Log = Console.Write;

    var blog = context.Blogs.First(b => b.Title == "One Unicorn");

    blog.Posts.First().Title = "Green Eggs and Ham";

    blog.Posts.Add(new Post { Title = "I do not like them!" });

    context.SaveChangesAsync().Wait();
}
```  

<span data-ttu-id="1048f-120">Verrà generato l'output seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-120">This will generate the following output:</span></span>  

``` SQL
SELECT TOP (1)
    [Extent1].[Id] AS [Id],
    [Extent1].[Title] AS [Title]
    FROM [dbo].[Blogs] AS [Extent1]
    WHERE (N'One Unicorn' = [Extent1].[Title]) AND ([Extent1].[Title] IS NOT NULL)
-- Executing at 10/8/2013 10:55:41 AM -07:00
-- Completed in 4 ms with result: SqlDataReader

SELECT
    [Extent1].[Id] AS [Id],
    [Extent1].[Title] AS [Title],
    [Extent1].[BlogId] AS [BlogId]
    FROM [dbo].[Posts] AS [Extent1]
    WHERE [Extent1].[BlogId] = @EntityKeyValue1
-- EntityKeyValue1: '1' (Type = Int32)
-- Executing at 10/8/2013 10:55:41 AM -07:00
-- Completed in 2 ms with result: SqlDataReader

UPDATE [dbo].[Posts]
SET [Title] = @0
WHERE ([Id] = @1)
-- @0: 'Green Eggs and Ham' (Type = String, Size = -1)
-- @1: '1' (Type = Int32)
-- Executing asynchronously at 10/8/2013 10:55:41 AM -07:00
-- Completed in 12 ms with result: 1

INSERT [dbo].[Posts]([Title], [BlogId])
VALUES (@0, @1)
SELECT [Id]
FROM [dbo].[Posts]
WHERE @@ROWCOUNT > 0 AND [Id] = scope_identity()
-- @0: 'I do not like them!' (Type = String, Size = -1)
-- @1: '1' (Type = Int32)
-- Executing asynchronously at 10/8/2013 10:55:41 AM -07:00
-- Completed in 2 ms with result: SqlDataReader
```  

<span data-ttu-id="1048f-121">Si noti che si tratta dell'output presumendo che sia già stata eseguita l'inizializzazione del database.</span><span class="sxs-lookup"><span data-stu-id="1048f-121">(Note that this is the output assuming any database initialization has already happened.</span></span> <span data-ttu-id="1048f-122">Se l'inizializzazione del database non è già stata eseguita, verrà visualizzato molto altro output che Mostra tutte le migrazioni di lavoro eseguite dietro le quinte per verificare o creare un nuovo database.</span><span class="sxs-lookup"><span data-stu-id="1048f-122">If database initialization had not already happened then there would be a lot more output showing all the work Migrations does under the covers to check for or create a new database.)</span></span>  

## <a name="what-gets-logged"></a><span data-ttu-id="1048f-123">Cosa viene registrato?</span><span class="sxs-lookup"><span data-stu-id="1048f-123">What gets logged?</span></span>  

<span data-ttu-id="1048f-124">Quando viene impostata la proprietà log, verranno registrate tutte le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="1048f-124">When the Log property is set all of the following will be logged:</span></span>  

- <span data-ttu-id="1048f-125">SQL per tutti i diversi tipi di comandi.</span><span class="sxs-lookup"><span data-stu-id="1048f-125">SQL for all different kinds of commands.</span></span> <span data-ttu-id="1048f-126">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="1048f-126">For example:</span></span>  
    - <span data-ttu-id="1048f-127">Query, incluse le query LINQ normali, le query eSQL e le query non elaborate da metodi come SQLQuery</span><span class="sxs-lookup"><span data-stu-id="1048f-127">Queries, including normal LINQ queries, eSQL queries, and raw queries from methods such as SqlQuery</span></span>  
    - <span data-ttu-id="1048f-128">Inserimenti, aggiornamenti ed eliminazioni generate come parte di SaveChanges</span><span class="sxs-lookup"><span data-stu-id="1048f-128">Inserts, updates, and deletes generated as part of SaveChanges</span></span>  
    - <span data-ttu-id="1048f-129">Relazione che carica query come quelle generate dal caricamento lazy</span><span class="sxs-lookup"><span data-stu-id="1048f-129">Relationship loading queries such as those generated by lazy loading</span></span>  
- <span data-ttu-id="1048f-130">Parametri</span><span class="sxs-lookup"><span data-stu-id="1048f-130">Parameters</span></span>  
- <span data-ttu-id="1048f-131">Indica se il comando viene eseguito in modo asincrono</span><span class="sxs-lookup"><span data-stu-id="1048f-131">Whether or not the command is being executed asynchronously</span></span>  
- <span data-ttu-id="1048f-132">Timestamp che indica quando è iniziata l'esecuzione del comando</span><span class="sxs-lookup"><span data-stu-id="1048f-132">A timestamp indicating when the command started executing</span></span>  
- <span data-ttu-id="1048f-133">Indica se il comando è stato completato correttamente, non è riuscito generando un'eccezione oppure, per async, è stato annullato</span><span class="sxs-lookup"><span data-stu-id="1048f-133">Whether or not the command completed successfully, failed by throwing an exception, or, for async, was canceled</span></span>  
- <span data-ttu-id="1048f-134">Indicazione del valore del risultato</span><span class="sxs-lookup"><span data-stu-id="1048f-134">Some indication of the result value</span></span>  
- <span data-ttu-id="1048f-135">Quantità approssimativa di tempo impiegato per eseguire il comando.</span><span class="sxs-lookup"><span data-stu-id="1048f-135">The approximate amount of time it took to execute the command.</span></span> <span data-ttu-id="1048f-136">Si noti che questo è il tempo di invio del comando per ottenere nuovamente l'oggetto risultato.</span><span class="sxs-lookup"><span data-stu-id="1048f-136">Note that this is the time from sending the command to getting the result object back.</span></span> <span data-ttu-id="1048f-137">Non è incluso il tempo necessario per leggere i risultati.</span><span class="sxs-lookup"><span data-stu-id="1048f-137">It does not include time to read the results.</span></span>  

<span data-ttu-id="1048f-138">Esaminando l'output di esempio precedente, ognuno dei quattro comandi registrati è:</span><span class="sxs-lookup"><span data-stu-id="1048f-138">Looking at the example output above, each of the four commands logged are:</span></span>  

- <span data-ttu-id="1048f-139">Query risultante dalla chiamata al contesto. Blog. prima</span><span class="sxs-lookup"><span data-stu-id="1048f-139">The query resulting from the call to context.Blogs.First</span></span>  
    - <span data-ttu-id="1048f-140">Si noti che il metodo ToString per ottenere SQL non funzionava per questa query perché "First" non fornisce un oggetto IQueryable su cui è possibile chiamare ToString</span><span class="sxs-lookup"><span data-stu-id="1048f-140">Notice that the ToString method of getting the SQL would not have worked for this query since “First” does not provide an IQueryable on which ToString could be called</span></span>  
- <span data-ttu-id="1048f-141">Query risultante dal caricamento lazy del Blog. Post</span><span class="sxs-lookup"><span data-stu-id="1048f-141">The query resulting from the lazy-loading of blog.Posts</span></span>  
    - <span data-ttu-id="1048f-142">Si notino i dettagli del parametro per il valore della chiave per cui è in corso il caricamento lazy</span><span class="sxs-lookup"><span data-stu-id="1048f-142">Notice the parameter details for the key value for which lazy loading is happening</span></span>  
    - <span data-ttu-id="1048f-143">Vengono registrate solo le proprietà del parametro impostate sui valori non predefiniti.</span><span class="sxs-lookup"><span data-stu-id="1048f-143">Only properties of the parameter that are set to non-default values are logged.</span></span> <span data-ttu-id="1048f-144">Ad esempio, la proprietà Size viene visualizzata solo se è diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="1048f-144">For example, the Size property is only shown if it is non-zero.</span></span>  
- <span data-ttu-id="1048f-145">Due comandi risultanti da SaveChangesAsync; uno per l'aggiornamento per modificare un titolo post, l'altro per un inserimento per aggiungere un nuovo post</span><span class="sxs-lookup"><span data-stu-id="1048f-145">Two commands resulting from SaveChangesAsync; one for the update to change a post title, the other for an insert to add a new post</span></span>  
    - <span data-ttu-id="1048f-146">Si notino i dettagli del parametro per le proprietà FK e title</span><span class="sxs-lookup"><span data-stu-id="1048f-146">Notice the parameter details for the FK and Title properties</span></span>  
    - <span data-ttu-id="1048f-147">Si noti che questi comandi vengono eseguiti in modo asincrono</span><span class="sxs-lookup"><span data-stu-id="1048f-147">Notice that these commands are being executed asynchronously</span></span>  

## <a name="logging-to-different-places"></a><span data-ttu-id="1048f-148">Registrazione in posizioni diverse</span><span class="sxs-lookup"><span data-stu-id="1048f-148">Logging to different places</span></span>  

<span data-ttu-id="1048f-149">Come illustrato sopra, la registrazione alla console è molto semplice.</span><span class="sxs-lookup"><span data-stu-id="1048f-149">As shown above logging to the console is super easy.</span></span> <span data-ttu-id="1048f-150">È anche facile accedere a memoria, file e così via usando diversi tipi di [TextWriter](https://msdn.microsoft.com/library/system.io.textwriter.aspx).</span><span class="sxs-lookup"><span data-stu-id="1048f-150">It’s also easy to log to memory, file, etc. by using different kinds of [TextWriter](https://msdn.microsoft.com/library/system.io.textwriter.aspx).</span></span>  

<span data-ttu-id="1048f-151">Se si ha familiarità con LINQ to SQL si può notare che in LINQ to SQL la proprietà log è impostata sull'oggetto TextWriter effettivo (ad esempio, console. out) mentre in EF la proprietà log è impostata su un metodo che accetta una stringa (ad esempio, console. Write o console. out. Write).</span><span class="sxs-lookup"><span data-stu-id="1048f-151">If you are familiar with LINQ to SQL you might notice that in LINQ to SQL the Log property is set to the actual TextWriter object (for example, Console.Out) while in EF the Log property is set to a method that accepts a string (for example, Console.Write or Console.Out.Write).</span></span> <span data-ttu-id="1048f-152">Il motivo è quello di separare EF da TextWriter accettando qualsiasi delegato che può fungere da sink per le stringhe.</span><span class="sxs-lookup"><span data-stu-id="1048f-152">The reason for this is to decouple EF from TextWriter by accepting any delegate that can act as a sink for strings.</span></span> <span data-ttu-id="1048f-153">Si supponga, ad esempio, di avere già un Framework di registrazione e di definire un metodo di registrazione come il seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-153">For example, imagine that you already have some logging framework and it defines a logging method like so:</span></span>  

``` csharp
public class MyLogger
{
    public void Log(string component, string message)
    {
        Console.WriteLine("Component: {0} Message: {1} ", component, message);
    }
}
```  

<span data-ttu-id="1048f-154">Questa operazione può essere collegata alla proprietà del log EF in questo modo:</span><span class="sxs-lookup"><span data-stu-id="1048f-154">This could be hooked up to the EF Log property like this:</span></span>  

``` csharp
var logger = new MyLogger();
context.Database.Log = s => logger.Log("EFApp", s);
```  

## <a name="result-logging"></a><span data-ttu-id="1048f-155">Registrazione risultati</span><span class="sxs-lookup"><span data-stu-id="1048f-155">Result logging</span></span>  

<span data-ttu-id="1048f-156">Il logger predefinito registra il testo del comando (SQL), i parametri e la riga "in esecuzione" con un timestamp prima che il comando venga inviato al database.</span><span class="sxs-lookup"><span data-stu-id="1048f-156">The default logger logs command text (SQL), parameters, and the “Executing” line with a timestamp before the command is sent to the database.</span></span> <span data-ttu-id="1048f-157">Una riga "completata" che contiene il tempo trascorso viene registrata dopo l'esecuzione del comando.</span><span class="sxs-lookup"><span data-stu-id="1048f-157">A “completed” line containing elapsed time is logged following execution of the command.</span></span>  

<span data-ttu-id="1048f-158">Si noti che per i comandi asincroni la riga "completata" non viene registrata fino a quando l'attività asincrona non viene effettivamente completata, non riesce o viene annullata.</span><span class="sxs-lookup"><span data-stu-id="1048f-158">Note that for async commands the “completed” line is not logged until the async task actually completes, fails, or is canceled.</span></span>  

<span data-ttu-id="1048f-159">La riga "completata" contiene informazioni diverse a seconda del tipo di comando e se l'esecuzione ha avuto esito positivo o negativo.</span><span class="sxs-lookup"><span data-stu-id="1048f-159">The “completed” line contains different information depending on the type of command and whether or not execution was successful.</span></span>  

### <a name="successful-execution"></a><span data-ttu-id="1048f-160">Esecuzione completata</span><span class="sxs-lookup"><span data-stu-id="1048f-160">Successful execution</span></span>  

<span data-ttu-id="1048f-161">Per i comandi che vengono completati correttamente, l'output è "completato in x ms con risultato:" seguito da un'indicazione del risultato.</span><span class="sxs-lookup"><span data-stu-id="1048f-161">For commands that complete successfully the output is “Completed in x ms with result: “ followed by some indication of what the result was.</span></span> <span data-ttu-id="1048f-162">Per i comandi che restituiscono un lettore di dati, l'indicazione del risultato è il tipo di [DbDataReader](https://msdn.microsoft.com/library/system.data.common.dbdatareader.aspx) restituito.</span><span class="sxs-lookup"><span data-stu-id="1048f-162">For commands that return a data reader the result indication is the type of [DbDataReader](https://msdn.microsoft.com/library/system.data.common.dbdatareader.aspx) returned.</span></span> <span data-ttu-id="1048f-163">Per i comandi che restituiscono un valore integer, ad esempio il comando Update illustrato sopra, il risultato visualizzato è tale integer.</span><span class="sxs-lookup"><span data-stu-id="1048f-163">For commands that return an integer value such as the update command shown above the result shown is that integer.</span></span>  

### <a name="failed-execution"></a><span data-ttu-id="1048f-164">Esecuzione non riuscita</span><span class="sxs-lookup"><span data-stu-id="1048f-164">Failed execution</span></span>  

<span data-ttu-id="1048f-165">Per i comandi che hanno esito negativo generando un'eccezione, l'output contiene il messaggio dell'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1048f-165">For commands that fail by throwing an exception, the output contains the message from the exception.</span></span> <span data-ttu-id="1048f-166">Se ad esempio si usa sqlQuery per eseguire una query su una tabella esistente, l'output del log potrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-166">For example, using SqlQuery to query against a table that does exist will result in log output something like this:</span></span>  

``` SQL
SELECT * from ThisTableIsMissing
-- Executing at 5/13/2013 10:19:05 AM
-- Failed in 1 ms with error: Invalid object name 'ThisTableIsMissing'.
```  

### <a name="canceled-execution"></a><span data-ttu-id="1048f-167">Esecuzione annullata</span><span class="sxs-lookup"><span data-stu-id="1048f-167">Canceled execution</span></span>  

<span data-ttu-id="1048f-168">Per i comandi asincroni in cui l'attività viene annullata, il risultato potrebbe essere un errore con un'eccezione, poiché si tratta spesso del provider ADO.NET sottostante quando viene eseguito un tentativo di annullamento.</span><span class="sxs-lookup"><span data-stu-id="1048f-168">For async commands where the task is canceled the result could be failure with an exception, since this is what the underlying ADO.NET provider often does when an attempt is made to cancel.</span></span> <span data-ttu-id="1048f-169">Se questa operazione non viene eseguita e l'attività viene annullata in modo corretto, l'output sarà simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-169">If this doesn’t happen and the task is canceled cleanly then the output will look something like this:</span></span>  

```console
update Blogs set Title = 'No' where Id = -1
-- Executing asynchronously at 5/13/2013 10:21:10 AM
-- Canceled in 1 ms
```  

## <a name="changing-log-content-and-formatting"></a><span data-ttu-id="1048f-170">Modifica del contenuto e della formattazione del log</span><span class="sxs-lookup"><span data-stu-id="1048f-170">Changing log content and formatting</span></span>  

<span data-ttu-id="1048f-171">In copre la proprietà database. log si avvale di un oggetto DatabaseLogFormatter.</span><span class="sxs-lookup"><span data-stu-id="1048f-171">Under the covers the Database.Log property makes use of a DatabaseLogFormatter object.</span></span> <span data-ttu-id="1048f-172">Questo oggetto associa efficacemente un'implementazione di IDbCommandInterceptor (vedere di seguito) a un delegato che accetta stringhe e un DbContext.</span><span class="sxs-lookup"><span data-stu-id="1048f-172">This object effectively binds an IDbCommandInterceptor implementation (see below) to a delegate that accepts strings and a DbContext.</span></span> <span data-ttu-id="1048f-173">Ciò significa che i metodi su DatabaseLogFormatter vengono chiamati prima e dopo l'esecuzione di comandi da EF.</span><span class="sxs-lookup"><span data-stu-id="1048f-173">This means that methods on DatabaseLogFormatter are called before and after the execution of commands by EF.</span></span> <span data-ttu-id="1048f-174">Questi metodi DatabaseLogFormatter raccolgono e formattano l'output del log e lo inviano al delegato.</span><span class="sxs-lookup"><span data-stu-id="1048f-174">These DatabaseLogFormatter methods gather and format log output and send it to the delegate.</span></span>  

### <a name="customizing-databaselogformatter"></a><span data-ttu-id="1048f-175">Personalizzazione di DatabaseLogFormatter</span><span class="sxs-lookup"><span data-stu-id="1048f-175">Customizing DatabaseLogFormatter</span></span>  

<span data-ttu-id="1048f-176">La modifica degli elementi registrati e della relativa formattazione può essere eseguita creando una nuova classe che deriva da DatabaseLogFormatter ed esegue l'override dei metodi in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="1048f-176">Changing what is logged and how it is formatted can be achieved by creating a new class that derives from DatabaseLogFormatter and overrides methods as appropriate.</span></span> <span data-ttu-id="1048f-177">I metodi più comuni per eseguire l'override sono:</span><span class="sxs-lookup"><span data-stu-id="1048f-177">The most common methods to override are:</span></span>  

- <span data-ttu-id="1048f-178">LogCommand: esegue l'override di questo per modificare il modo in cui vengono registrati i comandi prima che vengano eseguiti.</span><span class="sxs-lookup"><span data-stu-id="1048f-178">LogCommand – Override this to change how commands are logged before they are executed.</span></span> <span data-ttu-id="1048f-179">Per impostazione predefinita, LogCommand chiama LogParameter per ogni parametro; è possibile scegliere di eseguire la stessa operazione in sostituzione o di gestire i parametri in modo diverso.</span><span class="sxs-lookup"><span data-stu-id="1048f-179">By default LogCommand calls LogParameter for each parameter; you may choose to do the same in your override or handle parameters differently instead.</span></span>  
- <span data-ttu-id="1048f-180">LogResult: esegue l'override di questo per modificare il modo in cui viene registrato il risultato dell'esecuzione di un comando.</span><span class="sxs-lookup"><span data-stu-id="1048f-180">LogResult – Override this to change how the outcome from executing a command is logged.</span></span>  
- <span data-ttu-id="1048f-181">LogParameter: esegue l'override di questo per modificare la formattazione e il contenuto della registrazione dei parametri.</span><span class="sxs-lookup"><span data-stu-id="1048f-181">LogParameter – Override this to change the formatting and content of parameter logging.</span></span>  

<span data-ttu-id="1048f-182">Si supponga, ad esempio, di voler registrare solo una singola riga prima che ogni comando venga inviato al database.</span><span class="sxs-lookup"><span data-stu-id="1048f-182">For example, suppose we wanted to log just a single line before each command is sent to the database.</span></span> <span data-ttu-id="1048f-183">Questa operazione può essere eseguita con due sostituzioni:</span><span class="sxs-lookup"><span data-stu-id="1048f-183">This can be done with two overrides:</span></span>  

- <span data-ttu-id="1048f-184">Eseguire l'override di LogCommand per formattare e scrivere la riga singola di SQL</span><span class="sxs-lookup"><span data-stu-id="1048f-184">Override LogCommand to format and write the single line of SQL</span></span>  
- <span data-ttu-id="1048f-185">Eseguire l'override di LogResult per non eseguire alcuna operazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-185">Override LogResult to do nothing.</span></span>  

<span data-ttu-id="1048f-186">Il codice sarà simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-186">The code would look something like this:</span></span>

``` csharp
public class OneLineFormatter : DatabaseLogFormatter
{
    public OneLineFormatter(DbContext context, Action<string> writeAction)
        : base(context, writeAction)
    {
    }

    public override void LogCommand<TResult>(
        DbCommand command, DbCommandInterceptionContext<TResult> interceptionContext)
    {
        Write(string.Format(
            "Context '{0}' is executing command '{1}'{2}",
            Context.GetType().Name,
            command.CommandText.Replace(Environment.NewLine, ""),
            Environment.NewLine));
    }

    public override void LogResult<TResult>(
        DbCommand command, DbCommandInterceptionContext<TResult> interceptionContext)
    {
    }
}
```  

<span data-ttu-id="1048f-187">Per registrare l'output, è sufficiente chiamare il metodo Write che invierà l'output al delegato di scrittura configurato.</span><span class="sxs-lookup"><span data-stu-id="1048f-187">To log output simply call the Write method which will send output to the configured write delegate.</span></span>  

<span data-ttu-id="1048f-188">Si noti che questo codice consente di rimuovere semplicisticamente le interruzioni di riga solo come esempio.</span><span class="sxs-lookup"><span data-stu-id="1048f-188">(Note that this code does simplistic removal of line breaks just as an example.</span></span> <span data-ttu-id="1048f-189">Probabilmente non funzionerà correttamente per la visualizzazione di SQL complesso.</span><span class="sxs-lookup"><span data-stu-id="1048f-189">It will likely not work well for viewing complex SQL.)</span></span>  

### <a name="setting-the-databaselogformatter"></a><span data-ttu-id="1048f-190">Impostazione di DatabaseLogFormatter</span><span class="sxs-lookup"><span data-stu-id="1048f-190">Setting the DatabaseLogFormatter</span></span>  

<span data-ttu-id="1048f-191">Una volta creata una nuova classe DatabaseLogFormatter, è necessario registrarla con EF.</span><span class="sxs-lookup"><span data-stu-id="1048f-191">Once a new DatabaseLogFormatter class has been created it needs to be registered with EF.</span></span> <span data-ttu-id="1048f-192">Questa operazione viene eseguita usando la configurazione basata su codice.</span><span class="sxs-lookup"><span data-stu-id="1048f-192">This is done using code-based configuration.</span></span> <span data-ttu-id="1048f-193">In breve, ciò significa creare una nuova classe che deriva da DbConfiguration nello stesso assembly della classe DbContext e quindi chiamare SetDatabaseLogFormatter nel costruttore di questa nuova classe.</span><span class="sxs-lookup"><span data-stu-id="1048f-193">In a nutshell this means creating a new class that derives from DbConfiguration in the same assembly as your DbContext class and then calling SetDatabaseLogFormatter in the constructor of this new class.</span></span> <span data-ttu-id="1048f-194">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="1048f-194">For example:</span></span>  

``` csharp
public class MyDbConfiguration : DbConfiguration
{
    public MyDbConfiguration()
    {
        SetDatabaseLogFormatter(
            (context, writeAction) => new OneLineFormatter(context, writeAction));
    }
}
```  

### <a name="using-the-new-databaselogformatter"></a><span data-ttu-id="1048f-195">Uso del nuovo DatabaseLogFormatter</span><span class="sxs-lookup"><span data-stu-id="1048f-195">Using the new DatabaseLogFormatter</span></span>  

<span data-ttu-id="1048f-196">Questo nuovo DatabaseLogFormatter verrà ora usato ogni volta che viene impostato database. log.</span><span class="sxs-lookup"><span data-stu-id="1048f-196">This new DatabaseLogFormatter will now be used anytime Database.Log is set.</span></span> <span data-ttu-id="1048f-197">In questo modo, l'esecuzione del codice dalla parte 1 determinerà l'output seguente:</span><span class="sxs-lookup"><span data-stu-id="1048f-197">So, running the code from part 1 will now result in the following output:</span></span>  

```console
Context 'BlogContext' is executing command 'SELECT TOP (1) [Extent1].[Id] AS [Id], [Extent1].[Title] AS [Title]FROM [dbo].[Blogs] AS [Extent1]WHERE (N'One Unicorn' = [Extent1].[Title]) AND ([Extent1].[Title] IS NOT NULL)'
Context 'BlogContext' is executing command 'SELECT [Extent1].[Id] AS [Id], [Extent1].[Title] AS [Title], [Extent1].[BlogId] AS [BlogId]FROM [dbo].[Posts] AS [Extent1]WHERE [Extent1].[BlogId] = @EntityKeyValue1'
Context 'BlogContext' is executing command 'update [dbo].[Posts]set [Title] = @0where ([Id] = @1)'
Context 'BlogContext' is executing command 'insert [dbo].[Posts]([Title], [BlogId])values (@0, @1)select [Id]from [dbo].[Posts]where @@rowcount > 0 and [Id] = scope_identity()'
```  

## <a name="interception-building-blocks"></a><span data-ttu-id="1048f-198">Blocchi predefiniti di intercettazione</span><span class="sxs-lookup"><span data-stu-id="1048f-198">Interception building blocks</span></span>  

<span data-ttu-id="1048f-199">Fino a questo punto abbiamo esaminato come usare DbContext. database. log per registrare il database SQL generato da EF.</span><span class="sxs-lookup"><span data-stu-id="1048f-199">So far we have looked at how to use DbContext.Database.Log to log the SQL generated by EF.</span></span> <span data-ttu-id="1048f-200">Tuttavia, questo codice è in realtà una facciata relativamente sottile rispetto ad alcuni blocchi predefiniti di basso livello per un'intercettazione più generale.</span><span class="sxs-lookup"><span data-stu-id="1048f-200">But this code is actually a relatively thin facade over some low-level building blocks for more general interception.</span></span>  

### <a name="interception-interfaces"></a><span data-ttu-id="1048f-201">Interfacce di intercettazione</span><span class="sxs-lookup"><span data-stu-id="1048f-201">Interception interfaces</span></span>  

<span data-ttu-id="1048f-202">Il codice di intercettazione è basato sul concetto di interfacce di intercettazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-202">The interception code is built around the concept of interception interfaces.</span></span> <span data-ttu-id="1048f-203">Queste interfacce ereditano da IDbInterceptor e definiscono metodi che vengono chiamati quando EF esegue un'azione.</span><span class="sxs-lookup"><span data-stu-id="1048f-203">These interfaces inherit from IDbInterceptor and define methods that are called when EF performs some action.</span></span> <span data-ttu-id="1048f-204">Lo scopo è quello di avere un'interfaccia per ogni tipo di oggetto intercettato.</span><span class="sxs-lookup"><span data-stu-id="1048f-204">The intent is to have one interface per type of object being intercepted.</span></span> <span data-ttu-id="1048f-205">Ad esempio, l'interfaccia IDbCommandInterceptor definisce i metodi che vengono chiamati prima che EF effettua una chiamata a ExecuteNonQuery, ExecuteScalar, ExecuteReader e ai metodi correlati.</span><span class="sxs-lookup"><span data-stu-id="1048f-205">For example, the IDbCommandInterceptor interface defines methods that are called before EF makes a call to ExecuteNonQuery, ExecuteScalar, ExecuteReader, and related methods.</span></span> <span data-ttu-id="1048f-206">Analogamente, l'interfaccia definisce i metodi che vengono chiamati al completamento di ciascuna di queste operazioni.</span><span class="sxs-lookup"><span data-stu-id="1048f-206">Likewise, the interface defines methods that are called when each of these operations completes.</span></span> <span data-ttu-id="1048f-207">La classe DatabaseLogFormatter esaminata in precedenza implementa questa interfaccia per registrare i comandi.</span><span class="sxs-lookup"><span data-stu-id="1048f-207">The DatabaseLogFormatter class that we looked at above implements this interface to log commands.</span></span>  

### <a name="the-interception-context"></a><span data-ttu-id="1048f-208">Contesto di intercettazione</span><span class="sxs-lookup"><span data-stu-id="1048f-208">The interception context</span></span>  

<span data-ttu-id="1048f-209">Osservando i metodi definiti in una delle interfacce dell'intercettore è evidente che a ogni chiamata viene assegnato un oggetto di tipo DbInterceptionContext o un tipo derivato da questo, ad esempio DbCommandInterceptionContext \<\> .</span><span class="sxs-lookup"><span data-stu-id="1048f-209">Looking at the methods defined on any of the interceptor interfaces it is apparent that every call is given an object of type DbInterceptionContext or some type derived from this such as DbCommandInterceptionContext\<\>.</span></span> <span data-ttu-id="1048f-210">Questo oggetto contiene informazioni contestuali sull'azione che EF sta assumendo.</span><span class="sxs-lookup"><span data-stu-id="1048f-210">This object contains contextual information about the action that EF is taking.</span></span> <span data-ttu-id="1048f-211">Se, ad esempio, l'azione viene eseguita per conto di un DbContext, il DbContext viene incluso nel DbInterceptionContext.</span><span class="sxs-lookup"><span data-stu-id="1048f-211">For example, if the action is being taken on behalf of a DbContext, then the DbContext is included in the DbInterceptionContext.</span></span> <span data-ttu-id="1048f-212">Analogamente, per i comandi eseguiti in modo asincrono, il flag asincrono viene impostato su DbCommandInterceptionContext.</span><span class="sxs-lookup"><span data-stu-id="1048f-212">Similarly, for commands that are being executed asynchronously, the IsAsync flag is set on DbCommandInterceptionContext.</span></span>  

### <a name="result-handling"></a><span data-ttu-id="1048f-213">Gestione dei risultati</span><span class="sxs-lookup"><span data-stu-id="1048f-213">Result handling</span></span>  

<span data-ttu-id="1048f-214">La \<\> classe DbCommandInterceptionContext contiene le proprietà denominate result, OriginalResult, Exception e originalException.</span><span class="sxs-lookup"><span data-stu-id="1048f-214">The DbCommandInterceptionContext\<\> class contains a properties called Result, OriginalResult, Exception, and OriginalException.</span></span> <span data-ttu-id="1048f-215">Queste proprietà vengono impostate su null/zero per le chiamate ai metodi di intercettazione che vengono chiamate prima dell'esecuzione dell'operazione, ovvero per... Esecuzione di metodi.</span><span class="sxs-lookup"><span data-stu-id="1048f-215">These properties are set to null/zero for calls to the interception methods that are called before the operation is executed — that is, for the …Executing methods.</span></span> <span data-ttu-id="1048f-216">Se l'operazione viene eseguita e ha esito positivo, result e OriginalResult vengono impostati sul risultato dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-216">If the operation is executed and succeeds, then Result and OriginalResult are set to the result of the operation.</span></span> <span data-ttu-id="1048f-217">Questi valori possono quindi essere osservati nei metodi di intercettazione che vengono chiamati dopo l'esecuzione dell'operazione, ovvero sul... Metodi eseguiti.</span><span class="sxs-lookup"><span data-stu-id="1048f-217">These values can then be observed in the interception methods that are called after the operation has executed — that is, on the …Executed methods.</span></span> <span data-ttu-id="1048f-218">Analogamente, se l'operazione genera, verranno impostate le proprietà Exception e originalException.</span><span class="sxs-lookup"><span data-stu-id="1048f-218">Likewise, if the operation throws, then the Exception and OriginalException properties will be set.</span></span>  

#### <a name="suppressing-execution"></a><span data-ttu-id="1048f-219">Eliminazione dell'esecuzione</span><span class="sxs-lookup"><span data-stu-id="1048f-219">Suppressing execution</span></span>  

<span data-ttu-id="1048f-220">Se un intercettore imposta la proprietà Result prima dell'esecuzione del comando (in uno dei... Eseguendo metodi), EF non tenterà di eseguire effettivamente il comando, ma userà invece il set di risultati.</span><span class="sxs-lookup"><span data-stu-id="1048f-220">If an interceptor sets the Result property before the command has executed (in one of the …Executing methods) then EF will not attempt to actually execute the command, but will instead just use the result set.</span></span> <span data-ttu-id="1048f-221">In altre parole, l'intercettore può impedire l'esecuzione del comando, ma EF continua come se il comando fosse stato eseguito.</span><span class="sxs-lookup"><span data-stu-id="1048f-221">In other words, the interceptor can suppress execution of the command but have EF continue as if the command had been executed.</span></span>  

<span data-ttu-id="1048f-222">Un esempio di come questa operazione può essere utilizzata è il batch dei comandi che è stato tradizionalmente eseguito con un provider di wrapping.</span><span class="sxs-lookup"><span data-stu-id="1048f-222">An example of how this might be used is the command batching that has traditionally been done with a wrapping provider.</span></span> <span data-ttu-id="1048f-223">L'intercettore archivia il comando per un'esecuzione successiva come batch, ma "finge" per EF che il comando è stato eseguito normalmente.</span><span class="sxs-lookup"><span data-stu-id="1048f-223">The interceptor would store the command for later execution as a batch but would “pretend” to EF that the command had executed as normal.</span></span> <span data-ttu-id="1048f-224">Si noti che questa operazione richiede più di questo per implementare l'invio in batch, ma questo è un esempio di come è possibile usare la modifica del risultato dell'intercettazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-224">Note that it requires more than this to implement batching, but this is an example of how changing the interception result might be used.</span></span>  

<span data-ttu-id="1048f-225">L'esecuzione può anche essere eliminata impostando la proprietà Exception in uno dei... Esecuzione di metodi.</span><span class="sxs-lookup"><span data-stu-id="1048f-225">Execution can also be suppressed by setting the Exception property in one of the …Executing methods.</span></span> <span data-ttu-id="1048f-226">Questo fa sì che EF continui come se l'esecuzione dell'operazione non fosse riuscita generando l'eccezione specificata.</span><span class="sxs-lookup"><span data-stu-id="1048f-226">This causes EF to continue as if execution of the operation had failed by throwing the given exception.</span></span> <span data-ttu-id="1048f-227">Questo può, ovviamente, causare l'arresto anomalo dell'applicazione, ma potrebbe anche essere un'eccezione temporanea o un'altra eccezione gestita da EF.</span><span class="sxs-lookup"><span data-stu-id="1048f-227">This may, of course, cause the application to crash, but it may also be a transient exception or some other exception that is handled by EF.</span></span> <span data-ttu-id="1048f-228">Ad esempio, questo può essere usato negli ambienti di test per testare il comportamento di un'applicazione quando l'esecuzione del comando ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="1048f-228">For example, this could be used in test environments to test the behavior of an application when command execution fails.</span></span>  

#### <a name="changing-the-result-after-execution"></a><span data-ttu-id="1048f-229">Modifica del risultato dopo l'esecuzione</span><span class="sxs-lookup"><span data-stu-id="1048f-229">Changing the result after execution</span></span>  

<span data-ttu-id="1048f-230">Se un intercettore imposta la proprietà Result dopo l'esecuzione del comando (in uno dei... Metodi eseguiti), EF utilizzerà il risultato modificato anziché il risultato effettivamente restituito dall'operazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-230">If an interceptor sets the Result property after the command has executed (in one of the …Executed methods) then EF will use the changed result instead of the result that was actually returned from the operation.</span></span> <span data-ttu-id="1048f-231">Analogamente, se un intercettore imposta la proprietà Exception dopo l'esecuzione del comando, EF genererà l'eccezione set come se l'operazione avesse generato l'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1048f-231">Similarly, if an interceptor sets the Exception property after the command has executed, then EF will throw the set exception as if the operation had thrown the exception.</span></span>  

<span data-ttu-id="1048f-232">Un intercettore può inoltre impostare la proprietà Exception su null per indicare che non deve essere generata alcuna eccezione.</span><span class="sxs-lookup"><span data-stu-id="1048f-232">An interceptor can also set the Exception property to null to indicate that no exception should be thrown.</span></span> <span data-ttu-id="1048f-233">Questo può essere utile se l'esecuzione dell'operazione non è riuscita, ma l'intercettore desidera che EF continui come se l'operazione avesse avuto esito positivo.</span><span class="sxs-lookup"><span data-stu-id="1048f-233">This can be useful if execution of the operation failed but the interceptor wishes EF to continue as if the operation had succeeded.</span></span> <span data-ttu-id="1048f-234">Questa operazione comporta in genere anche l'impostazione del risultato, in modo che Entity Framework abbia un valore di risultato da usare come continuerà.</span><span class="sxs-lookup"><span data-stu-id="1048f-234">This usually also involves setting the Result so that EF has some result value to work with as it continues.</span></span>  

#### <a name="originalresult-and-originalexception"></a><span data-ttu-id="1048f-235">OriginalResult ed OriginalException</span><span class="sxs-lookup"><span data-stu-id="1048f-235">OriginalResult and OriginalException</span></span>  

<span data-ttu-id="1048f-236">Dopo l'esecuzione di un'operazione da parte di EF, verranno impostate le proprietà Result e OriginalResult se l'esecuzione non ha esito negativo oppure le proprietà Exception e originalException se l'esecuzione non è riuscita con un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="1048f-236">After EF has executed an operation it will set either the Result and OriginalResult properties if execution did not fail or the Exception and OriginalException properties if execution failed with an exception.</span></span>  

<span data-ttu-id="1048f-237">Le proprietà OriginalResult e originalException sono di sola lettura e vengono impostate solo da EF dopo l'esecuzione effettiva di un'operazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-237">The OriginalResult and OriginalException properties are read-only and are only set by EF after actually executing an operation.</span></span> <span data-ttu-id="1048f-238">Queste proprietà non possono essere impostate dagli intercettori.</span><span class="sxs-lookup"><span data-stu-id="1048f-238">These properties cannot be set by interceptors.</span></span> <span data-ttu-id="1048f-239">Ciò significa che qualsiasi intercettore può distinguere tra un'eccezione o un risultato che è stato impostato da un altro intercettore anziché l'eccezione reale o il risultato che si è verificato durante l'esecuzione dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="1048f-239">This means that any interceptor can distinguish between an exception or result that has been set by some other interceptor as opposed to the real exception or result that occurred when the operation was executed.</span></span>  

### <a name="registering-interceptors"></a><span data-ttu-id="1048f-240">Registrazione degli intercettori</span><span class="sxs-lookup"><span data-stu-id="1048f-240">Registering interceptors</span></span>  

<span data-ttu-id="1048f-241">Quando una classe che implementa una o più interfacce di intercettazione è stata creata, può essere registrata con EF usando la classe DbInterception.</span><span class="sxs-lookup"><span data-stu-id="1048f-241">Once a class that implements one or more of the interception interfaces has been created it can be registered with EF using the DbInterception class.</span></span> <span data-ttu-id="1048f-242">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="1048f-242">For example:</span></span>  

``` csharp
DbInterception.Add(new NLogCommandInterceptor());
```  

<span data-ttu-id="1048f-243">Gli intercettori possono essere registrati anche a livello di dominio dell'applicazione usando il meccanismo di configurazione basato sul codice DbConfiguration.</span><span class="sxs-lookup"><span data-stu-id="1048f-243">Interceptors can also be registered at the app-domain level using the DbConfiguration code-based configuration mechanism.</span></span>  

### <a name="example-logging-to-nlog"></a><span data-ttu-id="1048f-244">Esempio: registrazione in NLog</span><span class="sxs-lookup"><span data-stu-id="1048f-244">Example: Logging to NLog</span></span>  

<span data-ttu-id="1048f-245">È necessario riunirle in un esempio che usa IDbCommandInterceptor e [NLog](https://nlog-project.org/) per:</span><span class="sxs-lookup"><span data-stu-id="1048f-245">Let’s put all this together into an example that using IDbCommandInterceptor and [NLog](https://nlog-project.org/) to:</span></span>  

- <span data-ttu-id="1048f-246">Registra un avviso per qualsiasi comando eseguito in modo non asincrono</span><span class="sxs-lookup"><span data-stu-id="1048f-246">Log a warning for any command that is executed non-asynchronously</span></span>  
- <span data-ttu-id="1048f-247">Registra un errore per qualsiasi comando che genera un'eccezione durante l'esecuzione</span><span class="sxs-lookup"><span data-stu-id="1048f-247">Log an error for any command that throws when executed</span></span>  

<span data-ttu-id="1048f-248">Ecco la classe che esegue la registrazione, che deve essere registrata come illustrato in precedenza:</span><span class="sxs-lookup"><span data-stu-id="1048f-248">Here’s the class that does the logging, which should be registered as shown above:</span></span>  

``` csharp
public class NLogCommandInterceptor : IDbCommandInterceptor
{
    private static readonly Logger Logger = LogManager.GetCurrentClassLogger();

    public void NonQueryExecuting(
        DbCommand command, DbCommandInterceptionContext<int> interceptionContext)
    {
        LogIfNonAsync(command, interceptionContext);
    }

    public void NonQueryExecuted(
        DbCommand command, DbCommandInterceptionContext<int> interceptionContext)
    {
        LogIfError(command, interceptionContext);
    }

    public void ReaderExecuting(
        DbCommand command, DbCommandInterceptionContext<DbDataReader> interceptionContext)
    {
        LogIfNonAsync(command, interceptionContext);
    }

    public void ReaderExecuted(
        DbCommand command, DbCommandInterceptionContext<DbDataReader> interceptionContext)
    {
        LogIfError(command, interceptionContext);
    }

    public void ScalarExecuting(
        DbCommand command, DbCommandInterceptionContext<object> interceptionContext)
    {
        LogIfNonAsync(command, interceptionContext);
    }

    public void ScalarExecuted(
        DbCommand command, DbCommandInterceptionContext<object> interceptionContext)
    {
        LogIfError(command, interceptionContext);
    }

    private void LogIfNonAsync<TResult>(
        DbCommand command, DbCommandInterceptionContext<TResult> interceptionContext)
    {
        if (!interceptionContext.IsAsync)
        {
            Logger.Warn("Non-async command used: {0}", command.CommandText);
        }
    }

    private void LogIfError<TResult>(
        DbCommand command, DbCommandInterceptionContext<TResult> interceptionContext)
    {
        if (interceptionContext.Exception != null)
        {
            Logger.Error("Command {0} failed with exception {1}",
                command.CommandText, interceptionContext.Exception);
        }
    }
}
```  

<span data-ttu-id="1048f-249">Si noti che questo codice usa il contesto di intercettazione per individuare quando un comando viene eseguito in modo non asincrono e per individuare quando si è verificato un errore durante l'esecuzione di un comando.</span><span class="sxs-lookup"><span data-stu-id="1048f-249">Notice how this code uses the interception context to discover when a command is being executed non-asynchronously and to discover when there was an error executing a command.</span></span>  
