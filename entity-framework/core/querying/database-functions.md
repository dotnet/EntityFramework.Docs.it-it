---
title: Funzioni di database-EF Core
description: Informazioni sulle funzioni di database supportate in EF Core Translation query
author: smitpatel
ms.date: 11/10/2020
uid: core/querying/database-functions
ms.openlocfilehash: 34ced2a602168f6ed84763c046ef581cb87026e8
ms.sourcegitcommit: 42bbf7f68e92c364c5fff63092d3eb02229f568d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/11/2020
ms.locfileid: "94503798"
---
# <a name="database-functions"></a><span data-ttu-id="5919a-103">Funzioni di database</span><span class="sxs-lookup"><span data-stu-id="5919a-103">Database Functions</span></span>

<span data-ttu-id="5919a-104">Le funzioni di database sono il database equivalente ai [metodi C#](/dotnet/csharp/programming-guide/classes-and-structs/methods).</span><span class="sxs-lookup"><span data-stu-id="5919a-104">Database functions are the database equivalent of [C# methods](/dotnet/csharp/programming-guide/classes-and-structs/methods).</span></span> <span data-ttu-id="5919a-105">Una funzione di database può essere richiamata con zero o più parametri e calcola il risultato in base ai valori dei parametri.</span><span class="sxs-lookup"><span data-stu-id="5919a-105">A database function can be invoked with zero or more parameters and it computes the result based on the parameter values.</span></span> <span data-ttu-id="5919a-106">La maggior parte dei database, che usano SQL per eseguire query, dispone del supporto per le funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-106">Most databases, which use SQL for querying have support for database functions.</span></span> <span data-ttu-id="5919a-107">SQL generato da EF Core Translation query consente inoltre di richiamare funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-107">So SQL generated by EF Core query translation also allows invoking database functions.</span></span> <span data-ttu-id="5919a-108">I metodi C# non devono tradurre esclusivamente in funzioni di database in EF Core.</span><span class="sxs-lookup"><span data-stu-id="5919a-108">C# methods don't have to translate strictly to database functions in EF Core.</span></span>

- <span data-ttu-id="5919a-109">Un metodo C# non può avere una funzione di database equivalente.</span><span class="sxs-lookup"><span data-stu-id="5919a-109">A C# method may not have an equivalent database function.</span></span>
  - <span data-ttu-id="5919a-110"><xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> il metodo viene convertito in un controllo null e un confronto con una stringa vuota nel database piuttosto che come funzione.</span><span class="sxs-lookup"><span data-stu-id="5919a-110"><xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> method translates to a null check and a comparison with an empty string in the database rather than a function.</span></span>
  - <span data-ttu-id="5919a-111"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> il metodo non ha un database equivalente perché il confronto tra stringhe non può essere rappresentato o imitato facilmente in un database.</span><span class="sxs-lookup"><span data-stu-id="5919a-111"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> method doesn't have database equivalent since string comparison can't be represented or mimicked easily in a database.</span></span>
- <span data-ttu-id="5919a-112">Una funzione di database non può avere un metodo C# equivalente.</span><span class="sxs-lookup"><span data-stu-id="5919a-112">A database function may not have an equivalent C# method.</span></span> <span data-ttu-id="5919a-113">L' `??` operatore in C#, che non dispone di alcun metodo, viene convertito nella `COALESCE` funzione nel database.</span><span class="sxs-lookup"><span data-stu-id="5919a-113">The `??` operator in C#, which doesn't have any method, translates to the `COALESCE` function in the database.</span></span>

## <a name="types-of-database-functions"></a><span data-ttu-id="5919a-114">Tipi di funzioni di database</span><span class="sxs-lookup"><span data-stu-id="5919a-114">Types of database functions</span></span>

<span data-ttu-id="5919a-115">EF Core generazione SQL supporta un subset di funzioni che possono essere utilizzate nei database di.</span><span class="sxs-lookup"><span data-stu-id="5919a-115">EF Core SQL generation supports a subset of functions that can be used in databases.</span></span> <span data-ttu-id="5919a-116">Questa limitazione deriva dalla possibilità di rappresentare una query in LINQ per la funzione di database specificata.</span><span class="sxs-lookup"><span data-stu-id="5919a-116">This limitation comes from the ability to represent a query in LINQ for the given database function.</span></span> <span data-ttu-id="5919a-117">Inoltre, ogni database ha un supporto variabile per le funzioni di database, pertanto EF Core fornisce un subset comune.</span><span class="sxs-lookup"><span data-stu-id="5919a-117">Further, each database has varying support of database functions, so EF Core provides a common subset.</span></span> <span data-ttu-id="5919a-118">Un provider di database è libero di estendere EF Core generazione SQL per supportare più modelli.</span><span class="sxs-lookup"><span data-stu-id="5919a-118">A database provider is free to extend EF Core SQL generation to support more patterns.</span></span> <span data-ttu-id="5919a-119">Di seguito sono riportati i tipi di funzioni di database EF Core supporta e identifica in modo univoco.</span><span class="sxs-lookup"><span data-stu-id="5919a-119">Following are the types of database functions EF Core supports and uniquely identifies.</span></span> <span data-ttu-id="5919a-120">Questi termini contribuiscono anche a comprendere quali sono le traduzioni integrate con i provider di EF Core.</span><span class="sxs-lookup"><span data-stu-id="5919a-120">These terms also help in understanding what translations come built in with EF Core providers.</span></span>

### <a name="built-in-vs-user-defined-functions"></a><span data-ttu-id="5919a-121">Funzioni predefinite di Visual Studio definite dall'utente</span><span class="sxs-lookup"><span data-stu-id="5919a-121">Built-in vs user-defined functions</span></span>

<span data-ttu-id="5919a-122">Le funzioni predefinite sono disponibili con il database predefinito, ma le funzioni definite dall'utente vengono definite in modo esplicito dall'utente nel database.</span><span class="sxs-lookup"><span data-stu-id="5919a-122">Built-in functions come with database predefined, but user-defined functions are explicitly defined by the user in the database.</span></span> <span data-ttu-id="5919a-123">Quando EF Core converte le query per l'utilizzo di funzioni di database, utilizza funzioni predefinite per assicurarsi che la funzione sia sempre disponibile nel database.</span><span class="sxs-lookup"><span data-stu-id="5919a-123">When EF Core translates queries to use database functions, it uses built-in functions to make sure that the function is always available on the database.</span></span> <span data-ttu-id="5919a-124">La distinzione delle funzioni predefinite è necessaria in alcuni database per generare correttamente SQL.</span><span class="sxs-lookup"><span data-stu-id="5919a-124">The distinction of built-in functions is necessary in some databases to generate SQL correctly.</span></span> <span data-ttu-id="5919a-125">Per SqlServer, ad esempio, è necessario che ogni funzione definita dall'utente venga richiamata con un nome qualificato dallo schema.</span><span class="sxs-lookup"><span data-stu-id="5919a-125">For example SqlServer requires that every user-defined function is invoked with a schema-qualified name.</span></span> <span data-ttu-id="5919a-126">Tuttavia, le funzioni predefinite in SqlServer non dispongono di uno schema.</span><span class="sxs-lookup"><span data-stu-id="5919a-126">But built-in functions in SqlServer don't have a schema.</span></span> <span data-ttu-id="5919a-127">PostgreSQL definisce la funzione incorporata nello `public` schema, ma possono essere richiamati con nomi qualificati dallo schema.</span><span class="sxs-lookup"><span data-stu-id="5919a-127">PostgreSQL defines built-in function in the `public` schema but they can be invoked with schema-qualified names.</span></span>

### <a name="aggregate-vs-scalar-vs-table-valued-functions"></a><span data-ttu-id="5919a-128">Funzioni di aggregazione e funzioni con valori di tabella</span><span class="sxs-lookup"><span data-stu-id="5919a-128">Aggregate vs scalar vs table-valued functions</span></span>

- <span data-ttu-id="5919a-129">Le funzioni scalari accettano valori scalari, ad esempio Integer o stringhe come parametri, e restituiscono come risultato un valore scalare.</span><span class="sxs-lookup"><span data-stu-id="5919a-129">Scalar functions take scalar values - like integers or strings - as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="5919a-130">Le funzioni scalari possono essere utilizzate in qualsiasi punto di SQL in cui è possibile passare un valore scalare.</span><span class="sxs-lookup"><span data-stu-id="5919a-130">Scalar functions can be used anywhere in SQL where a scalar value can be passed.</span></span>
- <span data-ttu-id="5919a-131">Le funzioni di aggregazione accettano un flusso di valori scalari come parametri e restituiscono un valore scalare come risultato.</span><span class="sxs-lookup"><span data-stu-id="5919a-131">Aggregate functions take a stream of scalar values as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="5919a-132">Le funzioni di aggregazione vengono applicate all'intero set di risultati della query o a un gruppo di valori generati dall'operatore di applicazione `GROUP BY` .</span><span class="sxs-lookup"><span data-stu-id="5919a-132">Aggregate functions are applied on the whole query result set or on a group of values generated by applying `GROUP BY` operator.</span></span>
- <span data-ttu-id="5919a-133">Le funzioni con valori di tabella accettano valori scalari come parametri e restituiscono come risultato un flusso di righe.</span><span class="sxs-lookup"><span data-stu-id="5919a-133">Table-valued functions take scalar values as parameter(s) and return a stream of rows as the result.</span></span> <span data-ttu-id="5919a-134">Le funzioni con valori di tabella vengono utilizzate come una clausola di origine della tabella `FROM` .</span><span class="sxs-lookup"><span data-stu-id="5919a-134">Table-valued functions are used as a table source in `FROM` clause.</span></span>

### <a name="niladic-functions"></a><span data-ttu-id="5919a-135">Funzioni senza parametri</span><span class="sxs-lookup"><span data-stu-id="5919a-135">Niladic functions</span></span>

<span data-ttu-id="5919a-136">Le funzioni senza parametri sono funzioni di database speciali che non dispongono di parametri e che devono essere richiamate senza parentesi.</span><span class="sxs-lookup"><span data-stu-id="5919a-136">Niladic functions are special database functions that don't have any parameters and must be invoked without parenthesis.</span></span> <span data-ttu-id="5919a-137">Sono simili all'accesso a proprietà/campi in un'istanza in C#.</span><span class="sxs-lookup"><span data-stu-id="5919a-137">They're similar to property/field access on an instance in C#.</span></span> <span data-ttu-id="5919a-138">Le funzioni senza parametri differiscono dalle funzioni senza parametri, poiché quest'ultima richiede parentesi vuote.</span><span class="sxs-lookup"><span data-stu-id="5919a-138">Niladic functions differ from parameter-less functions as the latter require empty parenthesis.</span></span> <span data-ttu-id="5919a-139">Non esiste un nome speciale per le funzioni di database che richiedono sempre le parentesi.</span><span class="sxs-lookup"><span data-stu-id="5919a-139">There's no special name for database functions that requires parenthesis always.</span></span> <span data-ttu-id="5919a-140">Un altro subset di funzioni di database in base al numero di parametri è Variadic funzioni.</span><span class="sxs-lookup"><span data-stu-id="5919a-140">Another subset of database functions based on parameter count is variadic functions.</span></span> <span data-ttu-id="5919a-141">Quando vengono richiamate, le funzioni Variadic possono assumere un numero variabile di parametri.</span><span class="sxs-lookup"><span data-stu-id="5919a-141">Variadic functions can take varying number of parameters when invoked.</span></span>

## <a name="database-function-mappings-in-ef-core"></a><span data-ttu-id="5919a-142">Mapping di funzioni di database in EF Core</span><span class="sxs-lookup"><span data-stu-id="5919a-142">Database function mappings in EF Core</span></span>

<span data-ttu-id="5919a-143">EF Core supporta tre diverse modalità di mapping tra funzioni C# e funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-143">EF Core supports three different ways of mapping between C# functions and database functions.</span></span>

### <a name="built-in-function-mapping"></a><span data-ttu-id="5919a-144">Mapping delle funzioni predefinite</span><span class="sxs-lookup"><span data-stu-id="5919a-144">Built-in function mapping</span></span>

<span data-ttu-id="5919a-145">Per impostazione predefinita EF Core provider forniscono i mapping per varie funzioni predefinite rispetto ai tipi primitivi.</span><span class="sxs-lookup"><span data-stu-id="5919a-145">By default EF Core providers provide mappings for various built-in functions over primitive types.</span></span> <span data-ttu-id="5919a-146">Ad esempio, viene <xref:System.String.ToLower?displayProperty=nameWithType> convertito `LOWER` in in SqlServer.</span><span class="sxs-lookup"><span data-stu-id="5919a-146">For example, <xref:System.String.ToLower?displayProperty=nameWithType> translates to `LOWER` in SqlServer.</span></span> <span data-ttu-id="5919a-147">Questa funzionalità consente agli utenti di scrivere facilmente query in LINQ.</span><span class="sxs-lookup"><span data-stu-id="5919a-147">This functionality allows users to write queries in LINQ seamlessly.</span></span> <span data-ttu-id="5919a-148">Viene in genere fornita una traduzione nel database che restituisce lo stesso risultato fornito dalla funzione C# sul lato client.</span><span class="sxs-lookup"><span data-stu-id="5919a-148">We usually provide a translation in the database that gives the same result as what the C# function provides on the client side.</span></span> <span data-ttu-id="5919a-149">A volte, per ottenere questo risultato, la traduzione effettiva potrebbe essere più complessa rispetto a una funzione di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-149">Sometimes, to achieve that, the actual translation could be something more complicated than a database function.</span></span> <span data-ttu-id="5919a-150">In alcuni scenari, viene anche fornita la traduzione più appropriata anziché la semantica C# corrispondente.</span><span class="sxs-lookup"><span data-stu-id="5919a-150">In some scenarios, we also provide the most appropriate translation rather than matching C# semantics.</span></span> <span data-ttu-id="5919a-151">La stessa funzionalità viene usata anche per fornire traduzioni comuni per alcuni degli accessi ai Membri C#.</span><span class="sxs-lookup"><span data-stu-id="5919a-151">The same feature is also used to provide common translations for some of the C# member accesses.</span></span> <span data-ttu-id="5919a-152">Ad esempio, viene <xref:System.String.Length?displayProperty=nameWithType> convertito `LEN` in in SqlServer.</span><span class="sxs-lookup"><span data-stu-id="5919a-152">For example, <xref:System.String.Length?displayProperty=nameWithType> translates to `LEN` in SqlServer.</span></span> <span data-ttu-id="5919a-153">Oltre ai provider, i writer di plug-in possono anche aggiungere altre traduzioni.</span><span class="sxs-lookup"><span data-stu-id="5919a-153">Apart from providers, plugin writers can also add additional translations.</span></span> <span data-ttu-id="5919a-154">Questa estendibilità è utile quando i plug-in aggiungono il supporto per più tipi come tipi primitivi e vogliono tradurre metodi su di essi.</span><span class="sxs-lookup"><span data-stu-id="5919a-154">This extensibility is useful when plugins add support for more types as primitive types and want to translate methods over them.</span></span>

### <a name="effunctions-mapping"></a><span data-ttu-id="5919a-155">EF. Mapping di funzioni</span><span class="sxs-lookup"><span data-stu-id="5919a-155">EF.Functions mapping</span></span>

<span data-ttu-id="5919a-156">Poiché non tutte le funzioni di database hanno funzioni C# equivalenti, i provider EF Core hanno metodi C# speciali per richiamare determinate funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-156">Since not all database functions have equivalent C# functions, EF Core providers have special C# methods to invoke certain database functions.</span></span> <span data-ttu-id="5919a-157">Questi metodi sono definiti come metodi di estensione su `EF.Functions` per essere usati nelle query LINQ.</span><span class="sxs-lookup"><span data-stu-id="5919a-157">These methods are defined as extension methods over `EF.Functions` to be used in LINQ queries.</span></span> <span data-ttu-id="5919a-158">Questi metodi sono specifici del provider perché sono strettamente legati a determinate funzioni di database.</span><span class="sxs-lookup"><span data-stu-id="5919a-158">These methods are provider-specific as they're closely tied with particular database functions.</span></span> <span data-ttu-id="5919a-159">Pertanto, un metodo che funziona per un provider probabilmente non funzionerà per nessun altro provider.</span><span class="sxs-lookup"><span data-stu-id="5919a-159">So a method that works for one provider will likely not work for any other provider.</span></span> <span data-ttu-id="5919a-160">Poiché l'intenzione di questi metodi è di richiamare una funzione di database nella query tradotta, il tentativo di valutarli sul client genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5919a-160">Further, since the intention of these methods is to invoke a database function in the translated query, trying to evaluate them on the client results in an exception.</span></span>

### <a name="user-defined-function-mapping"></a><span data-ttu-id="5919a-161">Mapping di funzioni definite dall'utente</span><span class="sxs-lookup"><span data-stu-id="5919a-161">User-defined function mapping</span></span>

<span data-ttu-id="5919a-162">Oltre ai mapping forniti dai provider di EF Core, gli utenti possono anche definire il mapping personalizzato.</span><span class="sxs-lookup"><span data-stu-id="5919a-162">Apart from mappings provided by EF Core providers, users can also define custom mapping.</span></span> <span data-ttu-id="5919a-163">Un mapping definito dall'utente estende la conversione delle query in base alle esigenze dell'utente.</span><span class="sxs-lookup"><span data-stu-id="5919a-163">A user-defined mapping extends the query translation according to the user needs.</span></span> <span data-ttu-id="5919a-164">Questa funzionalità è utile quando nel database sono presenti funzioni definite dall'utente, che l'utente desidera richiamare dalla query LINQ.</span><span class="sxs-lookup"><span data-stu-id="5919a-164">This functionality is useful when there are user-defined functions in the database, which the user wants to invoke from their LINQ query.</span></span>

## <a name="see-also"></a><span data-ttu-id="5919a-165">Vedi anche</span><span class="sxs-lookup"><span data-stu-id="5919a-165">See also</span></span>

- [<span data-ttu-id="5919a-166">SqlServer mapping delle funzioni predefinite</span><span class="sxs-lookup"><span data-stu-id="5919a-166">SqlServer built-in function mappings</span></span>](xref:core/providers/sql-server/functions)
- [<span data-ttu-id="5919a-167">Mapping delle funzioni predefinite SQLite</span><span class="sxs-lookup"><span data-stu-id="5919a-167">Sqlite built-in function mappings</span></span>](xref:core/providers/sqlite/functions)
- [<span data-ttu-id="5919a-168">Mapping delle funzioni predefinite di Cosmos</span><span class="sxs-lookup"><span data-stu-id="5919a-168">Cosmos built-in function mappings</span></span>](xref:core/providers/cosmos/functions)
