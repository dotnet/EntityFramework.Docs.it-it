---
title: Valori generati-EF Core
description: Come configurare la generazione di valori per le proprietà quando si usa Entity Framework Core
author: AndriySvyryd
ms.date: 11/06/2019
uid: core/modeling/generated-properties
ms.openlocfilehash: 347cedbf5fdebc985d75c6cad3c28f17d1344993
ms.sourcegitcommit: f3512e3a98e685a3ba409c1d0157ce85cc390cf4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/10/2020
ms.locfileid: "94429624"
---
# <a name="generated-values"></a><span data-ttu-id="c2f8c-103">Valori generati</span><span class="sxs-lookup"><span data-stu-id="c2f8c-103">Generated Values</span></span>

## <a name="value-generation-patterns"></a><span data-ttu-id="c2f8c-104">Modelli di generazione di valori</span><span class="sxs-lookup"><span data-stu-id="c2f8c-104">Value generation patterns</span></span>

<span data-ttu-id="c2f8c-105">Sono disponibili tre modelli di generazione dei valori che possono essere usati per le proprietà:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-105">There are three value generation patterns that can be used for properties:</span></span>

* <span data-ttu-id="c2f8c-106">Nessuna generazione di valori</span><span class="sxs-lookup"><span data-stu-id="c2f8c-106">No value generation</span></span>
* <span data-ttu-id="c2f8c-107">Valore generato in aggiunta</span><span class="sxs-lookup"><span data-stu-id="c2f8c-107">Value generated on add</span></span>
* <span data-ttu-id="c2f8c-108">Valore generato durante l'aggiunta o l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c2f8c-108">Value generated on add or update</span></span>

### <a name="no-value-generation"></a><span data-ttu-id="c2f8c-109">Nessuna generazione di valori</span><span class="sxs-lookup"><span data-stu-id="c2f8c-109">No value generation</span></span>

<span data-ttu-id="c2f8c-110">Nessuna generazione di valori indica che verrà sempre fornito un valore valido da salvare nel database.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-110">No value generation means that you will always supply a valid value to be saved to the database.</span></span> <span data-ttu-id="c2f8c-111">Questo valore valido deve essere assegnato a nuove entità prima che vengano aggiunte al contesto.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-111">This valid value must be assigned to new entities before they are added to the context.</span></span>

### <a name="value-generated-on-add"></a><span data-ttu-id="c2f8c-112">Valore generato in aggiunta</span><span class="sxs-lookup"><span data-stu-id="c2f8c-112">Value generated on add</span></span>

<span data-ttu-id="c2f8c-113">Il valore generato durante l'aggiunta indica che viene generato un valore per le nuove entità.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-113">Value generated on add means that a value is generated for new entities.</span></span>

<span data-ttu-id="c2f8c-114">A seconda del provider di database in uso, è possibile che i valori vengano generati lato client da EF o nel database.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-114">Depending on the database provider being used, values may be generated client side by EF or in the database.</span></span> <span data-ttu-id="c2f8c-115">Se il valore viene generato dal database, EF può assegnare un valore temporaneo quando si aggiunge l'entità al contesto.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-115">If the value is generated by the database, then EF may assign a temporary value when you add the entity to the context.</span></span> <span data-ttu-id="c2f8c-116">Questo valore temporaneo verrà quindi sostituito dal valore generato dal database durante `SaveChanges()` .</span><span class="sxs-lookup"><span data-stu-id="c2f8c-116">This temporary value will then be replaced by the database generated value during `SaveChanges()`.</span></span>

<span data-ttu-id="c2f8c-117">Se si aggiunge un'entità al contesto a cui è assegnato un valore assegnato alla proprietà, EF tenterà di inserire tale valore anziché generarne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-117">If you add an entity to the context that has a value assigned to the property, then EF will attempt to insert that value rather than generating a new one.</span></span> <span data-ttu-id="c2f8c-118">A una proprietà viene assegnato un valore se non viene assegnato il valore predefinito CLR (per, per `null` , `string` `0` `int` `Guid.Empty` per `Guid` e così via).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-118">A property is considered to have a value assigned if it is not assigned the CLR default value (`null` for `string`, `0` for `int`, `Guid.Empty` for `Guid`, etc.).</span></span> <span data-ttu-id="c2f8c-119">Per ulteriori informazioni, vedere [valori espliciti per le proprietà generate](xref:core/saving/explicit-values-generated-properties).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-119">For more information, see [Explicit values for generated properties](xref:core/saving/explicit-values-generated-properties).</span></span>

> [!WARNING]
> <span data-ttu-id="c2f8c-120">Il modo in cui il valore viene generato per le entità aggiunte dipenderà dal provider di database in uso.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-120">How the value is generated for added entities will depend on the database provider being used.</span></span> <span data-ttu-id="c2f8c-121">I provider di database possono impostare automaticamente la generazione di valori per alcuni tipi di proprietà, ma altri potrebbero richiedere di configurare manualmente la modalità di generazione del valore.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-121">Database providers may automatically set up value generation for some property types, but others may require you to manually set up how the value is generated.</span></span>
>
> <span data-ttu-id="c2f8c-122">Quando si utilizza SQL Server, ad esempio, i valori vengono generati automaticamente per `GUID` le proprietà (usando l'algoritmo GUID sequenziale SQL Server).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-122">For example, when using SQL Server, values will be automatically generated for `GUID` properties (using the SQL Server sequential GUID algorithm).</span></span> <span data-ttu-id="c2f8c-123">Tuttavia, se si specifica che una `DateTime` proprietà viene generata in aggiunta, è necessario configurare una modalità per la generazione dei valori.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-123">However, if you specify that a `DateTime` property is generated on add, then you must set up a way for the values to be generated.</span></span> <span data-ttu-id="c2f8c-124">A tale scopo, è possibile configurare un valore predefinito di `GETDATE()` , vedere [valori predefiniti](#default-values).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-124">One way to do this, is to configure a default value of `GETDATE()`, see [Default Values](#default-values).</span></span>

### <a name="value-generated-on-add-or-update"></a><span data-ttu-id="c2f8c-125">Valore generato durante l'aggiunta o l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c2f8c-125">Value generated on add or update</span></span>

<span data-ttu-id="c2f8c-126">Il valore generato durante l'aggiunta o l'aggiornamento indica che viene generato un nuovo valore ogni volta che il record viene salvato (inserimento o aggiornamento).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-126">Value generated on add or update means that a new value is generated every time the record is saved (insert or update).</span></span>

<span data-ttu-id="c2f8c-127">Analogamente `value generated on add` , se si specifica un valore per la proprietà in un'istanza appena aggiunta di un'entità, tale valore verrà inserito anziché un valore generato.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-127">Like `value generated on add`, if you specify a value for the property on a newly added instance of an entity, that value will be inserted rather than a value being generated.</span></span> <span data-ttu-id="c2f8c-128">È anche possibile impostare un valore esplicito durante l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-128">It is also possible to set an explicit value when updating.</span></span> <span data-ttu-id="c2f8c-129">Per ulteriori informazioni, vedere [valori espliciti per le proprietà generate](xref:core/saving/explicit-values-generated-properties).</span><span class="sxs-lookup"><span data-stu-id="c2f8c-129">For more information, see [Explicit values for generated properties](xref:core/saving/explicit-values-generated-properties).</span></span>

> [!WARNING]
> <span data-ttu-id="c2f8c-130">Il modo in cui il valore viene generato per le entità aggiunte e aggiornate dipenderà dal provider di database in uso.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-130">How the value is generated for added and updated entities will depend on the database provider being used.</span></span> <span data-ttu-id="c2f8c-131">I provider di database possono impostare automaticamente la generazione di valori per alcuni tipi di proprietà, mentre altri richiederanno di configurare manualmente la modalità di generazione del valore.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-131">Database providers may automatically set up value generation for some property types, while others will require you to manually set up how the value is generated.</span></span>
>
> <span data-ttu-id="c2f8c-132">Quando si utilizza SQL Server, ad esempio, `byte[]` le proprietà impostate come generate in Aggiungi o aggiorna e contrassegnate come token di concorrenza verranno impostate con il tipo di `rowversion` dati, in modo che i valori vengano generati nel database.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-132">For example, when using SQL Server, `byte[]` properties that are set as generated on add or update and marked as concurrency tokens, will be set up with the `rowversion` data type - so that values will be generated in the database.</span></span> <span data-ttu-id="c2f8c-133">Tuttavia, se si specifica che una `DateTime` proprietà viene generata durante l'aggiunta o l'aggiornamento, è necessario configurare una modalità per la generazione dei valori.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-133">However, if you specify that a `DateTime` property is generated on add or update, then you must set up a way for the values to be generated.</span></span> <span data-ttu-id="c2f8c-134">A tale scopo, è possibile configurare un valore predefinito di `GETDATE()` (vedere [valori predefiniti](#default-values)) per generare valori per le nuove righe.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-134">One way to do this, is to configure a default value of `GETDATE()` (see [Default Values](#default-values)) to generate values for new rows.</span></span> <span data-ttu-id="c2f8c-135">È quindi possibile usare un trigger di database per generare valori durante gli aggiornamenti, ad esempio il trigger di esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-135">You could then use a database trigger to generate values during updates (such as the following example trigger).</span></span>
>
> [!code-sql[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.sql)]

## <a name="value-generated-on-add"></a><span data-ttu-id="c2f8c-136">Valore generato in aggiunta</span><span class="sxs-lookup"><span data-stu-id="c2f8c-136">Value generated on add</span></span>

<span data-ttu-id="c2f8c-137">Per convenzione, le chiavi primarie non composite di tipo short, int, Long o GUID sono impostate per avere valori generati per le entità inserite, se un valore non è fornito dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-137">By convention, non-composite primary keys of type short, int, long, or Guid are set up to have values generated for inserted entities, if a value isn't provided by the application.</span></span> <span data-ttu-id="c2f8c-138">Il provider di database gestisce in genere la configurazione necessaria. una chiave primaria numerica in SQL Server, ad esempio, viene configurata automaticamente come colonna IDENTITY.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-138">Your database provider typically takes care of the necessary configuration; for example, a numeric primary key in SQL Server is automatically set up to be an IDENTITY column.</span></span>

<span data-ttu-id="c2f8c-139">È possibile configurare qualsiasi proprietà in modo che il relativo valore venga generato per le entità inserite come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-139">You can configure any property to have its value generated for inserted entities as follows:</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="c2f8c-140">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="c2f8c-140">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAdd.cs?name=ValueGeneratedOnAdd&highlight=5)]

### <a name="fluent-api"></a>[<span data-ttu-id="c2f8c-141">API Fluent</span><span class="sxs-lookup"><span data-stu-id="c2f8c-141">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAdd.cs?name=ValueGeneratedOnAdd&highlight=5)]

***

> [!WARNING]
> <span data-ttu-id="c2f8c-142">In questo modo, EF sa che i valori vengono generati per le entità aggiunte, non garantisce che EF configurerà il meccanismo effettivo per generare valori.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-142">This just lets EF know that values are generated for added entities, it does not guarantee that EF will set up the actual mechanism to generate values.</span></span> <span data-ttu-id="c2f8c-143">Per altri dettagli, vedere [valore generato nella sezione Aggiungi](#value-generated-on-add) .</span><span class="sxs-lookup"><span data-stu-id="c2f8c-143">See [Value generated on add](#value-generated-on-add) section for more details.</span></span>

### <a name="default-values"></a><span data-ttu-id="c2f8c-144">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="c2f8c-144">Default values</span></span>

<span data-ttu-id="c2f8c-145">Nei database relazionali, una colonna può essere configurata con un valore predefinito. Se viene inserita una riga senza un valore per tale colonna, verrà utilizzato il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-145">On relational databases, a column can be configured with a default value; if a row is inserted without a value for that column, the default value will be used.</span></span>

<span data-ttu-id="c2f8c-146">È possibile configurare un valore predefinito in una proprietà:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-146">You can configure a default value on a property:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/DefaultValue.cs?name=DefaultValue&highlight=5)]

<span data-ttu-id="c2f8c-147">È anche possibile specificare un frammento SQL usato per calcolare il valore predefinito:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-147">You can also specify a SQL fragment that is used to calculate the default value:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/DefaultValueSql.cs?name=DefaultValueSql&highlight=5)]

<span data-ttu-id="c2f8c-148">Se si specifica un valore predefinito, la proprietà viene configurata in modo implicito come valore generato durante l'aggiunta.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-148">Specifying a default value will implicitly configure the property as value generated on add.</span></span>

## <a name="value-generated-on-add-or-update"></a><span data-ttu-id="c2f8c-149">Valore generato durante l'aggiunta o l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c2f8c-149">Value generated on add or update</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="c2f8c-150">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="c2f8c-150">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedOnAddOrUpdate.cs?name=ValueGeneratedOnAddOrUpdate&highlight=5)]

### <a name="fluent-api"></a>[<span data-ttu-id="c2f8c-151">API Fluent</span><span class="sxs-lookup"><span data-stu-id="c2f8c-151">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedOnAddOrUpdate.cs?name=ValueGeneratedOnAddOrUpdate&highlight=5)]

<span data-ttu-id="c2f8c-152">\*\*_</span><span class="sxs-lookup"><span data-stu-id="c2f8c-152">\*\*_</span></span>

> [!WARNING]
> <span data-ttu-id="c2f8c-153">In questo modo EF sa che i valori vengono generati per le entità aggiunte o aggiornate, ma non garantisce che EF configurerà il meccanismo effettivo per generare valori.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-153">This just lets EF know that values are generated for added or updated entities, it does not guarantee that EF will set up the actual mechanism to generate values.</span></span> <span data-ttu-id="c2f8c-154">Per ulteriori informazioni, vedere la sezione [valore generato nella sezione Aggiungi o aggiorna](#value-generated-on-add-or-update) .</span><span class="sxs-lookup"><span data-stu-id="c2f8c-154">See [Value generated on add or update](#value-generated-on-add-or-update) section for more details.</span></span>

### <a name="computed-columns"></a><span data-ttu-id="c2f8c-155">Colonne calcolate</span><span class="sxs-lookup"><span data-stu-id="c2f8c-155">Computed columns</span></span>

<span data-ttu-id="c2f8c-156">Nella maggior parte dei database relazionali, una colonna può essere configurata in modo che il relativo valore venga calcolato nel database, in genere con un'espressione che fa riferimento ad altre colonne:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-156">On most relational databases, a column can be configured to have its value computed in the database, typically with an expression referring to other columns:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ComputedColumn.cs?name=DefaultComputedColumn)]

<span data-ttu-id="c2f8c-157">Il precedente crea una colonna calcolata _virtual \*, il cui valore viene calcolato ogni volta che viene recuperato dal database.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-157">The above creates a _virtual\* computed column, whose value is computed every time it is fetched from the database.</span></span> <span data-ttu-id="c2f8c-158">È inoltre possibile specificare che una colonna calcolata deve essere *archiviata* (talvolta denominata *permanente* ), ovvero viene calcolata a ogni aggiornamento della riga e viene archiviata su disco insieme a colonne normali:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-158">You may also specify that a computed column be *stored* (sometimes called *persisted* ), meaning that it is computed on every update of the row, and is stored on disk alongside regular columns:</span></span>

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ComputedColumn.cs?name=StoredComputedColumn)]

> [!NOTE]
> <span data-ttu-id="c2f8c-159">Il supporto per la creazione di colonne calcolate archiviate è stato aggiunto in EF Core 5,0.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-159">Support for creating stored computed columns was added in EF Core 5.0.</span></span>

## <a name="no-value-generation"></a><span data-ttu-id="c2f8c-160">Nessuna generazione di valori</span><span class="sxs-lookup"><span data-stu-id="c2f8c-160">No value generation</span></span>

<span data-ttu-id="c2f8c-161">La disabilitazione della generazione di valori in una proprietà è in genere necessaria se una convenzione la configura per la generazione di valori.</span><span class="sxs-lookup"><span data-stu-id="c2f8c-161">Disabling value generation on a property is typically necessary if a convention configures it for value generation.</span></span> <span data-ttu-id="c2f8c-162">Se, ad esempio, si dispone di una chiave primaria di tipo int, questa verrà impostata in modo implicito come valore generato durante l'aggiunta; Questa operazione può essere disabilitata tramite quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c2f8c-162">For example, if you have a primary key of type int, it will be implicitly set configured as value generated on add; you can disable this via the following:</span></span>

### <a name="data-annotations"></a>[<span data-ttu-id="c2f8c-163">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="c2f8c-163">Data Annotations</span></span>](#tab/data-annotations)

[!code-csharp[Main](../../../samples/core/Modeling/DataAnnotations/ValueGeneratedNever.cs?name=ValueGeneratedNever&highlight=3)]

### <a name="fluent-api"></a>[<span data-ttu-id="c2f8c-164">API Fluent</span><span class="sxs-lookup"><span data-stu-id="c2f8c-164">Fluent API</span></span>](#tab/fluent-api)

[!code-csharp[Main](../../../samples/core/Modeling/FluentAPI/ValueGeneratedNever.cs?name=ValueGeneratedNever&highlight=5)]

***
